from pwn import *
import trie_search

dic = open('dictonary')
dic = dic.read().split('\n')
#print patterns
#trie = trie_search.TrieSearch(patterns)

pause()


p = remote('192.168.0.123', 7777)

p.recvuntil('Stage')
p.recvline()
p.recvline()

#for pattern, start_idx in trie.search_all_patterns('command'):
#	print pattern, start_idx

while True:
	sw = 0
        print 'search'
        buf = p.recvline().strip()
        if '==' in buf:
                break
	for word in dic:
		if word in buf and len(word) > 1:
			sw = 1
			print word
			break
	if sw == 1:
		break


print 'search finish'
'''
while True:
	print 'search'
	buf = p.recvline().strip()
	if '==' in buf:
		break
	for pattern, start_idx in trie.search_all_patterns(buf):
		pause()
		print pattern, start_idx

print 'search finish'
'''
p.interactive()
