heap
bins
x/gx 0x7fea8058eb0b
attach 31255
attach 31225
heap
bins
x/gx 0x7fb2a3fdcaf5
attach 31392
bin
sx/gx 0x7f8a834a1aed
x/gx 0x7f8a834a1aed
p &__malloc_hook
x/gx 0x7f8a834a1b10 - 0x7f8a834a1afd
attach 31649
heap
bins
p &__malloc_hook
x/gx 0x7fc28aa6eb10
x/10i 0x00007fc28a6ef26a
q
r
heap
bis
p printf
p &printf
p &Malloc
x/10i 0x40096a
p Malloc
p free
p &free
x/10i 0x7ffff7df0e90
vmmap
x/gx 0x601000
q
q
q
q
disas main
disas Malloc
r
q
disas main
r
b * 0x0000000000400b72
c
r
si
q
r
p exit
p &exoit
p &exit
disas main
 b*0x0000000000400b72
r
ni
q
disas main
 b*0x0000000000400b72
r
si
ni
ni
si
ni
si
ni
ni
q
disas main
disas Free
b *0x0000000000400b72
r
ni
r
q
q
disas Free
b *0x0000000000400a53
c
r
0
ni
ni
q
r
r
heap
r
r
heap
r
heap
x/gx 0x603000
r
r
heap
r
heap
r
heap
x/gx 0x603000
q
r
heap
bins
x/gx from pwn import *
p = process('./babyheap')
e = ELF('./babyheap')
l = ELF('./libc.so.6')
context.log_level="debug"
def malloc(size, content):
        p.sendlineafter('> ','1')
        p.sendlineafter('size: ',str(size))
        p.sendlineafter('content: ',str(content))
def free(index):
        p.sendlineafter('> ','2')
        p.sendlineafter('index: ', str(index))
def show(index):
        p.sendlineafter('> ','3')
        p.sendlineafter('index: ', str(index))
x/gx 0x603400
x/gx 0x603410 + 496
heap
x/gx 0x603400 - x/gx 0x603000
x/gx 0x603400 -0x603000
attach 14488
c
heap
attach 14576
disas main
b *0x0000000000400b72
c
heap
bins
q
p main_arena
p _malloc_hook
p -_malloc_hook
q
q
p __malloc_hook
p &__malloc_hook
q
r
heap
p main_arena
x/gx 0x7ffff7dd1b20 - 16
attach 30413
heap
bins
q
attach 31014
attach 31266
heap
bins
x/gx 0x7f013df5bb20
q
heap
bins
x/gx 0x7f7b7c9a5b40
q
heap
bins
q
heap
bins
q
heap
bins
attach 1703
attach 1702
heap
bins
q
heap
bins
q
heap
bins
c
attach 3313
heap
bisn
c
heap
bins
q
heap
bins
q
heap
bisn
bins
x/gx 0x7fec950a4b20
q
heap
bins
x/gx 0x7faa55404b00
x/gx 0x7faa55404b00 - 50
x/gx 0x7faa55404aee - 3
x/gx 0x7faa55404aee +3
x/gx 0x7faa55404aee +5
x/gx 0x7faa55404aee +6
x/gx 0x7faa55404aee +7
q
heap
bins
x/gx 0x7f87d00d6aed
x/gx 0x7f87d00d6aed
x/gx 0x7f87d00d6afd - 0x7f87d00d6b10
x/gx 0x7f87d00d6b10 -0x7f87d00d6afd
attach 5761
heap
bins
x/gx 0x1b50000
q
bins
x/gx 0x7ff6f25edaed
quit
heap
bis
bins
x/gx 0x259d000
x/gx 0x7f73ae75aaed
q
heap
bins
x/gx 0x7f554ae4aaed
x/gx 0x7f554ae4aaed - 20
x/gx 0x7f554ae4aaed - 10
x/gx 0x7f554ae4aaed +10
x/gx 0x7f554ae4aaed +15
x/gx 0x7f554ae4aaed +0
x/gx 0x7f554ae4aaed +4
x/gx 0x7f554ae4aaed +6
x/gx 0x7f554ae4aaed +
x/gx 0x7f554ae4aaed 
x/gx 0x7f554ae4aaed - 1000
x/gx 0x7f554ae4aaed - 2000
q
heap
bins
x/gx 0x7fac24bc5aed
q
r
heap'
heap
bins
q
r
r
heap
bins
q
